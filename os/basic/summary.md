# 概述

## 参考

[CYC CS-Notes 计算机操作系统 - 概述](http://www.cyc2018.xyz/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20-%20%E6%A6%82%E8%BF%B0.html)

## 基本特征

### 1. 并发

并发是指宏观上在一段时间内能同时运行多个程序，而并行则指同一时刻能运行多个指令。

并行需要硬件支持，如多流水线、多核处理器或者分布式计算系统。

操作系统通过引入进程和线程，使得程序能够并发运行。

### 2. 共享

共享是指系统中的资源可以被多个并发进程共同使用。

有两种共享方式：互斥共享和同时共享。

互斥共享的资源称为临界资源，例如打印机等，在同一时刻只允许一个进程访问，需要用同步机制来实现互斥访问。

### 3. 虚拟

虚拟技术把一个物理实体转换为多个逻辑实体。

主要有两种虚拟技术：时（时间）分复用技术和空（空间）分复用技术。

多个进程能在同一个处理器上并发执行使用了时分复用技术，让每个进程轮流占用处理器，每次只执行一小个时间片并快速切换。

虚拟内存使用了空分复用技术，它将物理内存抽象为地址空间，每个进程都有各自的地址空间。地址空间的页被映射到物理内存，地址空间的页并不需要全部在物理内存中，当使用到一个没有在物理内存的页时，执行页面置换算法，将该页置换到内存中。

* 时分复用：多个进程能在同一个处理器上并发执行，让每个进程轮流占用处理器，每次只执行一小个时间片并快速切换。
* 空分复用：虚拟内存，将物理内存抽象为地址空间，每个进程都有各自的地址空间。地址空间的页被映射到物理内存，地址空间的页并不需要全部在物理内存中，当使用到一个没有在物理内存的页时，执行页面置换算法将该页置换到内存中。

### 4. 异步

异步指进程不是一次性执行完毕，而是走走停停，以不可知的速度向前推进。

异步的另外一种含义是计算机多线程的异步处理。与同步处理相对，异步处理不用阻塞当前线程来等待处理完成，而是允许后续操作，直至其它线程将处理完成，并回调通知此线程。

// 也就是异步可以A和B都做，同步只能先做完A再做B。

## 基本功能

### 1. 进程管理

进程控制、进程同步、进程通信、死锁处理、处理机调度等。

### 2. 内存管理

内存分配、地址映射、内存保护与共享、虚拟内存等。

### 3. 文件管理

文件存储空间的管理、目录管理、文件读写管理和保护等。

### 4. 设备管理

完成用户的 I/O 请求，方便用户使用各种设备，并提高设备的利用率。

主要包括缓冲管理、设备分配、设备处理、虛拟设备等。

## 系统调用

如果一个进程在用户态需要使用内核态的功能，就进行系统调用从而陷入内核，由操作系统代为完成。

![](../../.gitbook/assets/image%20%2857%29.png)

Linux 的系统调用主要有以下这些：

| Task | Commands |
| :--- | :--- |
| 进程控制 | fork\(\); exit\(\); wait\(\); |
| 进程通信 | pipe\(\); shmget\(\); mmap\(\); |
| 文件操作 | open\(\); read\(\); write\(\); |
| 设备操作 | ioctl\(\); read\(\); write\(\); |
| 信息维护 | getpid\(\); alarm\(\); sleep\(\); |
| 安全 | chmod\(\); umask\(\); chown\(\); |

## 宏内核和微内核

### 1. 宏内核

> 宏内核也叫做大内核。

宏内核是将操作系统功能作为一个紧密结合的整体放到内核。由于各模块共享信息，因此有很高的性能。

### 2. 微内核

由于操作系统不断复杂，因此将一部分操作系统功能移出内核，从而降低内核的复杂性。移出的部分根据分层的原则划分成若干服务，相互独立。

在微内核结构下，操作系统被划分成小的、定义良好的模块，只有微内核这一个模块运行在内核态，其余模块运行在用户态。

因为需要频繁地在用户态和核心态之间进行切换，所以会有一定的性能损失。

![](../../.gitbook/assets/image%20%2856%29.png)

## 中断分类

> _维基百科_
>
> 在[计算机科学](https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)中，**中断**（英语：Interrupt）是指[处理器](https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%A4%AE%E8%99%95%E7%90%86%E5%99%A8)接收到来自硬件或软件的信号，提示发生了某个事件，应该被注意，这种情况就称为中断。
>
> 通常，在接收到来自外围硬件（相对于[中央处理器](https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%A4%AE%E5%A4%84%E7%90%86%E5%99%A8)和[内存](https://zh.wikipedia.org/wiki/%E5%86%85%E5%AD%98)）的[异步](https://zh.wikipedia.org/wiki/%E7%95%B0%E6%AD%A5)信号，或来自[软件](https://zh.wikipedia.org/wiki/%E8%BD%AF%E4%BB%B6)的[同步](https://zh.wikipedia.org/wiki/%E5%90%8C%E6%AD%A5)信号之后，处理器将会进行相应的硬件／软件处理。发出这样的信号称为进行[中断请求](https://zh.wikipedia.org/w/index.php?title=%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82&action=edit&redlink=1)（interrupt request，IRQ）。硬件中断导致处理器通过一个[运行信息切换](https://zh.wikipedia.org/wiki/%E4%B8%8A%E4%B8%8B%E6%96%87%E4%BA%A4%E6%8F%9B)（context switch）来保存执行状态（以程序计数器和程序状态字等寄存器信息为主）；软件中断则通常作为CPU指令集中的一个指令，以可编程的方式直接指示这种运行信息切换，并将处理导向一段中断处理代码。中断在计算机多任务处理，尤其是即时[系统](https://zh.wikipedia.org/wiki/%E7%B3%BB%E7%BB%9F)中尤为有用。这样的系统，包括运行于其上的操作系统，也被称为“中断驱动的”（interrupt-driven）。
>
> _百度百科_
>
> 当CPU（[中央处理器](https://baike.baidu.com/item/%E4%B8%AD%E5%A4%AE%E5%A4%84%E7%90%86%E5%99%A8)）执行一条现行指令的时候，如果外设向CPU发出中断请求，那么CPU在满足响应的情况下，将发出中断响应信号，与此同时关闭中断，表示CPU不在受理另外一个设备的中断。这时，CPU将寻找[中断请求](https://baike.baidu.com/item/%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82)源是哪一个设备，并保存CPU自己的[程序计数器](https://baike.baidu.com/item/%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8)（PC）的内容。然后，他将转移到处理该[中断源](https://baike.baidu.com/item/%E4%B8%AD%E6%96%AD%E6%BA%90)的[中断服务程序](https://baike.baidu.com/item/%E4%B8%AD%E6%96%AD%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F)。CPU在保存现场信息，设备服务（如交换数据）以后，将[恢复现场](https://baike.baidu.com/item/%E6%81%A2%E5%A4%8D%E7%8E%B0%E5%9C%BA)信息。在这些动作完成以后，开放中断，并返回到原来被中断的主程序的下一条指令。

### 1. 外中断

由 CPU 执行指令以外的事件引起，如 I/O 完成中断，表示设备输入/输出处理已经完成，处理器能够发送下一个输入/输出请求。

此外还有时钟中断、控制台中断等。

### 2. 异常

由 CPU 执行指令的内部事件引起，如非法操作码、地址越界、算术溢出等。

### 3. 陷入

在用户程序中使用系统调用。

